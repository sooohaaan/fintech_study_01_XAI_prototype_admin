{% extends "base.html" %}
{% block content %}
<h1>유저 스탯 관리</h1>
<div class="card guide-card">
    <div class="card-p">
        <div class="flex items-center gap-2 mb-2">
            <span class="badge badge-info">Data Management</span>
            <h3 class="font-bold text-sm">유저 금융 데이터 관리</h3>
        </div>
        <p class="text-sm text-sub">
            미션 자동 달성 여부를 판단하는 기준이 되는 유저의 금융 데이터(신용점수, DSR, 자산 연동 여부 등)를 조회하고 수정합니다.
        </p>
    </div>
</div>

<form method="get" class="mb-6 bg-soft rounded-lg flex gap-2 items-center flex-wrap p-4">
    <span class="font-semibold text-sub">기간 설정:</span>
    <input type="date" name="start_date" value="{{ start_date or '' }}" class="form-input w-auto">
    <span class="text-sub">~</span>
    <input type="date" name="end_date" value="{{ end_date or '' }}" class="form-input w-auto">
    <button type="submit" class="btn-primary">조회</button>
    <a href="/missions/deletion-logs" class="nav-btn">전체 기간</a>
</form>

<div class="table-wrapper">
    <table class="w-full">
        <thead><tr>
            <th>User ID</th>
            <th class="text-right">신용점수</th>
            <th class="text-right">DSR</th>
            <th class="text-right">카드사용률</th>
            <th class="text-center">연체</th>
            <th class="text-center">급여이체</th>
            <th class="text-center">관리</th>
        </tr></thead>
        <tbody>
            {% for s in stats %}
            <tr>
                <td class="font-bold">{{ s.user_id }}</td>
                <td class="text-right">{{ s.credit_score }}</td>
                <td class="text-right">{{ s.dsr }}%</td>
                <td class="text-right">{{ s.card_usage_rate }}%</td>
                <td class="text-center">{{ s.delinquency }}건</td>
                <td class="text-center">
                    {% if s.salary_transfer == 1 %}<span class="badge badge-success">Y</span>{% else %}<span class="badge badge-neutral">N</span>{% endif %}
                </td>
                <td class="text-center">
                    <a href="/user-stats/{{ s.user_id }}/edit" class="btn-tonal btn-sm">수정</a>
                </td>
            </tr>
            {% else %}
            <tr><td colspan="7" class="text-center text-sub p-4">데이터가 없습니다.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}