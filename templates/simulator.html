{% extends "base.html" %}
{% block content %}
    <h1>대출 추천 시뮬레이터</h1>

    <div class="card guide-card">
        <div class="card-p">
            <div class="flex items-center gap-2 mb-2">
                <span class="badge badge-info">Simulation Guide</span>
                <h3 class="font-bold text-sm">대출 추천 시뮬레이터</h3>
            </div>
            <div class="text-sm text-sub space-y-2">
                <p><strong>목적:</strong> 현재 설정된 신용 평가 가중치와 추천 알고리즘이 실제 사용자에게 어떤 결과를 보여줄지 미리 검증합니다.</p>
                <p><strong>사용 방법:</strong>
                    왼쪽 폼에 가상의 사용자 프로필(소득, 희망 금액, 직업 등)을 입력하고 '추천 실행' 버튼을 누르세요.<br>
                    오른쪽 결과 화면에서 추천된 상품 목록과 예상 금리, 그리고 <strong>AI의 추천 사유(XAI)</strong>를 확인할 수 있습니다.
                </p>
                <p><strong>참고:</strong> 이 시뮬레이션은 실제 데이터베이스에 저장되지 않는 테스트용입니다.</p>
            </div>
        </div>
    </div>

    <div class="info-banner">가상의 유저 프로필을 입력하여 현재 신용평가 가중치 설정이 추천 결과에 어떤 영향을 미치는지 미리 확인할 수 있습니다.</div>
    <div class="grid-1-2">
        <div class="card card-p h-fit">
            <h3 class="card-title mt-0 mb-4">가상 유저 프로필</h3>
            <form method="post">
                <label class="form-label">연소득 (원)</label>
                <input type="number" name="annual_income" value="{{ income }}" placeholder="예: 50000000" class="form-input mb-1">
                <p class="help-text mb-3">원 단위로 입력합니다.</p>
                <label class="form-label">희망 대출 금액 (원)</label>
                <input type="number" name="desired_amount" value="{{ amount }}" placeholder="예: 100000000" class="form-input mb-1">
                <p class="help-text mb-3">이 금액 이상을 지원하는 상품만 추천됩니다.</p>
                <label class="form-label">고용 형태 (안정성)</label>
                <select name="job_score" class="form-select mb-1">
                    <option value="1.0" {% if job_score == 1.0 %}selected{% endif %}>대기업/공무원 (매우 안정)</option>
                    <option value="0.8" {% if job_score == 0.8 %}selected{% endif %}>중견/중소기업 (안정)</option>
                    <option value="0.5" {% if job_score == 0.5 %}selected{% endif %}>프리랜서/계약직 (보통)</option>
                    <option value="0.2" {% if job_score == 0.2 %}selected{% endif %}>무직/기타 (불안정)</option>
                </select>
                <p class="help-text mb-3">고용 안정성 점수로 변환됩니다.</p>
                <label class="form-label">보유 자산 (원)</label>
                <input type="number" name="asset_amount" value="{{ asset_amount }}" placeholder="예: 200000000" class="form-input mb-1">
                <p class="help-text mb-3">부동산, 금융 자산 등 총액을 원 단위로 입력합니다.</p>
                <button type="submit" class="btn-accent w-full">추천 실행 (AI)</button>
            </form>
        </div>
        <div class="card card-p h-fit">
            <h3 class="card-title mt-0 mb-4">추천 결과</h3>
            {% if result_html %}
                <div class="table-wrapper">{{ result_html|safe }}</div>
                <p class="text-sub text-sm mt-2">* 예상 금리는 현재 설정된 가중치 정책과 유저 프로필에 따라 계산됩니다.</p>
            {% else %}
                <div class="bg-soft rounded-lg text-center text-muted p-4 dashed-border">왼쪽 폼에 정보를 입력하고 추천을 실행해보세요.</div>
            {% endif %}
        </div>
    </div>
{% endblock %}