{% extends "base.html" %}
{% from "macros.html" import summary_grid, status_badge, empty_state %}
{% block content %}
<h1>포인트 구매 내역</h1>
<a href="/point-products" class="nav-btn mb-4">상품 목록으로 돌아가기</a>
<div class="info-banner">유저들의 포인트 상품 구매 내역을 조회합니다.</div>

{{ summary_grid([
    {"label": "총 구매 건수", "value": total_purchases},
    {"label": "총 사용 포인트", "value": "{:,}".format(total_points_used) ~ "P", "color": "danger"}
], "mb-6", title="구매 내역 요약", badge="Purchases") }}

<div class="table-wrapper">
    <table class="w-full">
        <thead><tr>
            <th>구매 ID</th>
            <th>유저 ID</th>
            <th>상품명</th>
            <th class="text-right">사용 포인트</th>
            <th class="text-center">상태</th>
            <th>구매일</th>
        </tr></thead>
        <tbody>
            {% for p in purchases %}
            <tr>
                <td>{{ p.purchase_id }}</td>
                <td class="font-bold">{{ p.user_id }}</td>
                <td>{{ p.product_name or '(삭제된 상품)' }}</td>
                <td class="text-right font-bold">{{ "{:,}".format(p.point_cost) }}P</td>
                <td class="text-center">{{ status_badge(p.status, "purchase") }}</td>
                <td>{{ p.purchased_at }}</td>
            </tr>
            {% else %}
            {{ empty_state(6, "구매 내역이 없습니다.") }}
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}