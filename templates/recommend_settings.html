{% extends "base.html" %}
{% from "macros.html" import guide_card %}
{% block content %}
<h1>대출 추천 알고리즘 설정</h1>

{{ guide_card("Algorithm Guide", "대출 추천 알고리즘 설정",
    "사용자에게 대출 상품을 추천할 때의 우선순위와 필터링 규칙을 정의합니다. 변경 사항은 저장 즉시 추천 API에 적용됩니다.",
    [
        {"title": "최대 추천 수", "desc": "사용자 화면에 보여줄 상품 개수를 제한합니다."},
        {"title": "정렬 우선순위", "desc": "'금리 낮은 순' 또는 '한도 높은 순' 중 기본 정렬 방식을 선택합니다."},
        {"title": "금리 민감도", "desc": "신용 점수에 따라 금리가 변동되는 폭을 조절합니다. (1.0 = 기본)"}
    ]) }}

<form method="post">
    <div class="card card-p mb-6">
        <h3 class="card-title text-primary mt-0">추천 파라미터</h3>
        <div class="grid-2">
            <div>
                <label class="form-label">최대 추천 수</label>
                <input type="number" name="max_count" value="{{ max_count }}" min="1" max="20" class="form-input">
                <p class="help-text">사용자에게 보여줄 최대 추천 상품 수입니다. 권장: 3~7개.</p>
            </div>
            <div>
                <label class="form-label">정렬 우선순위</label>
                <select name="sort_priority" class="form-select">
                    <option value="rate" {% if sort_priority == 'rate' %}selected{% endif %}>예상 금리 낮은 순 (rate)</option>
                    <option value="limit" {% if sort_priority == 'limit' %}selected{% endif %}>대출 한도 높은 순 (limit)</option>
                </select>
                <p class="help-text">"금리 낮은 순"은 이자 부담 최소화, "한도 높은 순"은 대출 가능 금액 최대화 방향입니다.</p>
            </div>
            <div>
                <label class="form-label">Fallback 모드</label>
                <select name="fallback_mode" class="form-select">
                    <option value="show_all" {% if fallback_mode == 'show_all' %}selected{% endif %}>전체 상품 표시 (show_all)</option>
                    <option value="show_none" {% if fallback_mode == 'show_none' %}selected{% endif %}>빈 결과 반환 (show_none)</option>
                </select>
                <p class="help-text">희망 대출 금액을 지원하는 상품이 없을 때의 처리 방식입니다.</p>
            </div>
            <div>
                <label class="form-label">금리 스프레드 민감도</label>
                <input type="number" step="0.1" name="rate_sensitivity" value="{{ rate_sensitivity }}" min="0.1" max="3.0" class="form-input">
                <p class="help-text">1.0이 기본값입니다. 높을수록 신용 점수 차이에 따른 금리 차이가 커집니다.</p>
            </div>
        </div>
    </div>
    <div class="flex justify-end">
        <button type="submit" title="변경 사항을 저장합니다." class="btn-primary">설정 저장</button>
    </div>
</form>
{% endblock %}